{"description":" for each loops CFG is wrong as it loops back on the expression of the for each statement.\r\n\r\nThis can lead to wrong consumption of the stack as the expression is incorrectly evaluated if it is complex (with a conditional operator for instance)\r\n{code}\r\n private static void zip(Object dir, String s) throws IOException {\r\n    for (String n : dir.list(foo() ? \"**\" : \"\")) {\r\n      if (s.isEmpty()) {\r\n        relativePath \u003d n;\r\n      }\r\n    }\r\n  }\r\n{code}","component":"SonarJava","component_version":"3.8"}